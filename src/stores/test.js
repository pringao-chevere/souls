export function Skwid(e,a,t,n){let r=function(){const e={};function a(a,t,n,r,s){let o,i,c,u;'percussion'===a||'fx'===a?(o=t,i=n,u=s,(c=r).category=o):(i=t,c=n,u=r),e[a]||(e[a]=[]),e[a].push([i,c,u])}function t(e){return e}function n(e){return e}function r(e){return e}function s(e){return e}return a('percussion','kick','kick909',{gain:1.2,monotone:'E1',noise:!1,a:0,d:.2,s:.1,r:.3,duration:.25,max:.95,a_pitch:0,d_pitch:.245,s_pitch:-48,r_pitch:.5,duration_pitch:.245,max_pitch:24,osc_0_type:'sine',osc_0_detune:0,osc_1_type:'sine',osc_1_detune:0},{filter:t({type:'lowpass',Q:2,freq:1e3,gain:2,input_gain:1})}),a('percussion','kick','kick808',{gain:10,monotone:'A1',noise:!1,a:0,d:1,s:.001,r:.3,duration:.5,max:.95,osc_0_type:'sine',osc_0_detune:0,osc_1_type:'sine',osc_1_detune:-2400},{filter:t({type:'lowpass',Q:6,freq:200,gain:1,input_gain:1})}),a('percussion','kick','kickgoa',{gain:1,monotone:'E1',noise:!1,a:0,d:.8,s:.1,r:.5,duration:.5,max:.95,a_pitch:0,d_pitch:.2,s_pitch:-48,r_pitch:.5,duration_pitch:.245,max_pitch:35,osc_0_type:'sine',osc_0_detune:0,osc_1_type:'sine',osc_1_detune:0},{filter:t({type:'lowpass',Q:2,freq:900,gain:2,input_gain:1})}),a('percussion','snare','snare1',{gain:10,noise:!0,a:0,d:.3,s:.05,r:0,duration:.3,max:1},{filter:t({type:'bandpass',Q:5,freq:2e3,gain:1}),reverb:s({duration:1.5,decay:20,reverse:!1,freq:3e3,amount:.4})}),a('percussion','snare','snarepsy',{gain:10,noise:!0,a:0,d:.3,s:.05,r:0,duration:.3,max:1},{filter:t({type:'bandpass',Q:5,freq:2e3,gain:1}),reverb:s({duration:1.5,decay:20,reverse:!1,freq:3e3,amount:.4})}),a('percussion','perc','shaker',{gain:.8,noise:!0,lfo_type:'triangle',lfo_freq:3,lfo_amp:.2,a:.1,d:.1,s:.3,r:.5,duration:.25,max:.8},{filter:t({lfo_type:'sine',lfo_freq:25,lfo_gain:1e3,type:'highpass',Q:20,freq:6e3,gain:5,input_gain:1}),reverb:s({duration:3,decay:10,reverse:!1,freq:1e3,amount:.7})}),a('percussion','hat','hihatclosed',{gain:1.5,noise:!0,a:0,d:.05,s:.05,r:0,duration:.3,max:1},{filter:t({type:'highpass',Q:5,freq:12e3,gain:1}),reverb:s({duration:1.5,decay:25,reverse:!1,freq:3e3,amount:.2})}),a('percussion','hat','hihatopen',{gain:1,noise:!0,a:0,d:.2,s:.2,r:0,duration:.1,max:.8},{filter:t({type:'highpass',Q:9,freq:1e4,gain:5,input_gain:1}),delay:n({delay:.02,feedback:.1})}),a('percussion','clap','clap',{gain:15,noise:!0,a:0,d:.1,s:.09,r:.5,duration:.3,max:1},{filter:t({type:'bandpass',Q:10,freq:1400,gain:2}),reverb:s({duration:2,decay:20,reverse:!1,freq:2e3,amount:.5})}),a('percussion','perc','popcorndrum',{gain:10,monotone:'C2',a:0,d:.005,s:.05,r:0,duration:.01,max:.8,a_pitch:0,d_pitch:.1,s_pitch:-100,r_pitch:0,duration_pitch:.5,max_pitch:64,osc_0_type:'sawtooth',osc_1_type:'sine',osc_1_detune:-1200},{filter:t({lfo_type:'sine',lfo_freq:.6,lfo_gain:500,type:'bandpass',Q:2,freq:750,gain:1,input_gain:1}),reverb:s({duration:2,decay:20,reverse:!1,freq:2e3,amount:.2})}),a('percussion','perc','woodblock',{gain:1.2,noise:!1,lfo_type:'triangle',lfo_freq:3,lfo_amp:0,a:0,d:.05,s:.1,r:0,duration:.1,max:.9,a_pitch:0,d_pitch:.1,s_pitch:-48,r_pitch:0,duration_pitch:.1,max_pitch:36,osc_0_type:'square',osc_0_detune:0,osc_1_type:'square',osc_1_detune:-1200},{filter:t({lfo_type:'sine',lfo_freq:1,lfo_gain:0,type:'bandpass',Q:15,freq:750,gain:10,input_gain:1,a:0,d:.05,s:.1,r:0,max:1,negative:!0}),reverb:s({duration:1.2,decay:15,reverse:!1,freq:6e3,amount:.3})}),a('percussion','perc','lazerdrum',{gain:9,noise:!1,lfo_type:'triangle',lfo_freq:3,lfo_amp:0,a:0,d:.05,s:.1,r:0,duration:.1,max:.9,a_pitch:0,d_pitch:.2,s_pitch:-48,r_pitch:0,duration_pitch:.1,max_pitch:48,osc_0_type:'sawtooth',osc_0_detune:0,osc_1_type:'sawtooth',osc_1_detune:-1200},{filter:t({lfo_type:'sine',lfo_freq:1,lfo_gain:0,type:'bandpass',Q:1,freq:1e3,gain:1,input_gain:1,a:0,d:.01,s:.1,r:0,max:1,negative:!0,duration:.09}),delay:n({delay:.07,feedback:.5}),reverb:s({duration:1.2,decay:15,reverse:!1,freq:6e3,amount:.3})}),a('bass','synthwave80s',{r:.01,a:0,duration:.1,gain:1,osc_0_type:'sine',osc_0_detune:0,osc_1_type:'square',osc_1_detune:0},{filter:t({type:'lowpass',Q:5,freq:1e3,gain:2,input_gain:1})}),a('bass','naturaloctavebass',{r:.2,a:0,duration:.2,gain:1,osc_0_type:'triangle',osc_0_detune:0,osc_1_type:'sine',osc_1_detune:-1300},{filter:t({freq:450,Q:1,type:'lowpass',gain:3,input_gain:1})}),a('bass','squaresynthbass',{gain:1,a:0,d:.1,s:1,r:.1,duration:.1,max:.8,osc_0_type:'triangle',osc_0_detune:0,osc_1_type:'square',osc_1_detune:0},{filter:t({lfo_gain:0,type:'lowpass',Q:1,freq:500,gain:1.7,input_gain:1,a:.01,d:1,s:.5,r:1,max:1,negative:!1,duration:.5})}),a('bass','fingerpickedbass',{gain:.9,a:.001,d:.1,s:.3,r:.5,duration:.25,osc_0_type:'triangle',osc_0_detune:0,osc_1_type:'square',osc_1_detune:-1200},{filter:t({type:'bandpass',Q:1,freq:500,gain:5,input_gain:1,a:0,d:.1,s:.8,r:0,max:.05,negative:!1,duration:0})}),a('bass','psytrancebass',{gain:2,a:0,d:.2,s:.1,r:.3,duration:.15,max:.8},{filter:t({lfo_type:'sine',lfo_freq:1,lfo_gain:0,type:'lowpass',Q:5,freq:700,gain:1,input_gain:1,a:0,d:.15,s:.1,r:.3,max:.8,negative:!1,duration:.15})}),a('bass','deephousebass',{gain:2.5,noise:!1,a:.001,d:1,s:1e-4,r:1,duration:.9,max:.95,osc_0_type:'sine',osc_0_detune:0,osc_1_type:'sine',osc_1_detune:-2400,filter:t({type:'lowpass',Q:4,freq:600,gain:1,input_gain:1})}),a('bass','neurobass',{gain:1,maxNote:'G2',noise:!1,a:0,d:.2,s:.5,r:.1,duration:.25,max:1,a_pitch:0,d_pitch:.1,s_pitch:0,r_pitch:0,duration_pitch:.05,max_pitch:4,osc_0_type:'square',osc_0_detune:0,osc_1_type:'sine',osc_1_detune:0},{filter:t({type:'lowpass',Q:3,freq:2e3,gain:2,input_gain:1,a:0,d:.15,s:.1,r:.3,max:.8,negative:!1,duration:.15})}),a('fx','stab','respunchdelay',{gain:1,useSeconds:!0,a:0,d:.1,s:.3,r:.5,duration:.25,max:.8,osc_0_type:'sine',osc_0_detune:0,osc_1_type:'sine',osc_1_detune:0,a_pitch:0,d_pitch:.5,s_pitch:-24,r_pitch:.5,duration_pitch:.245,max_pitch:12},{filter:t({type:'bandpass',Q:2,freq:2e3,gain:1,a:0,d:0,s:0,r:0,max:0,negative:!1}),delay:n({delay:.375,feedback:.75}),reverb:s({duration:1,decay:2,reverse:!1,freq:8e3,amount:.5})}),a('fx','stab','reversepopcorn',{gain:5,maxNote:'C3',useSeconds:!0,a:0,d:.02,s:.2,r:1,duration:.1,max:.8,a_pitch:.5,d_pitch:.5,s_pitch:5,r_pitch:0,duration_pitch:.5,max_pitch:.9,osc_0_type:'sawtooth',osc_1_type:'square'},{filter:t({lfo_type:'sine',lfo_freq:1,lfo_gain:200,type:'bandpass',Q:1,freq:320,gain:1,input_gain:1}),delay:n({delay:.333,feedback:.5}),reverb:s({duration:1,decay:2,reverse:!0,freq:8e3,amount:.5})}),a('fx','sweepup','bpsweepup',{gain:2,useSeconds:!1,noise:!0,a:0,d:[8,'beats'],s:1,r:0,duration:8,max:1},{filter:t({type:'bandpass',Q:5,freq:5e3,gain:5,input_gain:1,a:[7.5,'beats'],d:[7.5,'beats'],s:1,r:0,max:1,negative:!1,duration:8}),panner:r({pan:0,lfo_type:'sine',lfo_freq:[.75,'beats'],lfo_gain:1}),reverb:s({duration:3,decay:20,reverse:!1,freq:1e4,amount:.7})}),a('fx','sweepdown','bpsweepdown',{gain:2,useSeconds:!1,noise:!0,a:0,d:[8,'beats'],s:1,r:0,duration:8,max:1},{filter:t({type:'bandpass',Q:6,freq:18e3,gain:5,input_gain:1,a:0,d:[8,'beats'],s:.001,r:0,max:1,negative:!1,duration:8}),panner:r({pan:0,lfo_type:'sine',lfo_freq:[.75,'beats'],lfo_gain:1}),reverb:s({duration:3,decay:20,reverse:!1,freq:1e4,amount:.7})}),a('fx','sweepup','hpsweepup',{gain:1,useSeconds:!1,noise:!0,a:[7.8,'beats'],d:.1,s:1,r:.1,duration:8,max:1},{filter:t({type:'highpass',Q:6,freq:2e4,gain:3,input_gain:1,a:[7.8,'beats'],d:.1,s:.001,r:0,max:1,negative:!1,duration:8}),panner:r({pan:0,lfo_type:'sine',lfo_freq:[.25,'beats'],lfo_gain:.3}),reverb:s({duration:3,decay:20,reverse:!1,freq:1e4,amount:.7})}),a('fx','sweepdown','hpsweepdown',{gain:1,useSeconds:!1,noise:!0,a:0,d:[3,'beats'],s:1,r:[2,'beats'],duration:8,max:1},{filter:t({type:'highpass',Q:6,freq:2e4,gain:3,input_gain:1,a:0,d:[4,'beats'],s:.001,r:0,max:1,negative:!1,duration:8}),panner:r({pan:0,lfo_type:'sine',lfo_freq:[.25,'beats'],lfo_gain:.3}),reverb:s({duration:3,decay:20,reverse:!1,freq:1e4,amount:.7})}),a('fx','stab','lazerchickenverb',{gain:10,monotone:'D2',useSeconds:!0,noise:!1,a:0,d:.05,s:.2,r:.2,duration:.05,max:.8,a_pitch:0,d_pitch:2.63,s_pitch:-48,r_pitch:.001,duration_pitch:1,max_pitch:12,osc_0_type:'sawtooth',osc_0_detune:0,osc_1_type:'sawtooth',osc_1_detune:0},{filter:t({lfo_type:'sine',lfo_freq:.2,lfo_gain:2e3,type:'bandpass',Q:10,freq:1500,gain:2,input_gain:1}),panner:r({lfo_type:'sine',lfo_freq:.9,lfo_gain:2}),reverb:s({duration:5,decay:20,reverse:!1,freq:2e3,amount:.5})}),a('fx','stab','lazerchickendelay',{gain:10,monotone:'D2',useSeconds:!0,noise:!1,a:0,d:.05,s:.2,r:.2,duration:.05,max:.8,a_pitch:0,d_pitch:2.63,s_pitch:-48,r_pitch:.001,duration_pitch:1,max_pitch:12,osc_0_type:'sawtooth',osc_0_detune:0,osc_1_type:'sawtooth',osc_1_detune:0},{filter:t({lfo_type:'sine',lfo_freq:.2,lfo_gain:2e3,type:'bandpass',Q:10,freq:1500,gain:2,input_gain:1}),delay:n({delay:.33,feedback:.3}),panner:r({lfo_type:'sine',lfo_freq:.9,lfo_gain:2}),reverb:s({duration:3,decay:30,reverse:!1,freq:2e3,amount:.5})}),a('fx','stab','lazergoose',{gain:10,monotone:'D3',useSeconds:!0,noise:!1,a:0,d:.05,s:.2,r:.2,duration:.05,max:.8,a_pitch:0,d_pitch:2.63,s_pitch:-64,r_pitch:.001,duration_pitch:1,max_pitch:24,osc_0_type:'square',osc_0_detune:0,osc_1_type:'square',osc_1_detune:-1200},{filter:t({lfo_type:'sine',lfo_freq:.2,lfo_gain:2e3,type:'bandpass',Q:10,freq:800,gain:2,input_gain:1}),delay:n({delay:.05,feedback:.5}),panner:r({lfo_type:'sine',lfo_freq:1.2,lfo_gain:1}),reverb:s({duration:3,decay:20,reverse:!1,freq:1e3,amount:.5})}),a('fx','stab','bpresmover',{gain:2,noise:!0,lfo_type:'triangle',lfo_freq:3,lfo_amp:.2,a:.1,d:.1,s:.2,r:.1,duration:.1,max:1},{filter:t({lfo_type:'sine',lfo_freq:.2,lfo_gain:1e3,type:'bandpass',Q:20,freq:2e3,gain:5,input_gain:1}),delay:n({delay:.15,feedback:.5}),panner:r({lfo_type:'sine',lfo_freq:5,lfo_gain:100}),reverb:s({duration:3,decay:10,reverse:!1,freq:1e3,amount:.7})}),a('lead','shineshimmerverb',{gain:2,a:0,d:.5,s:.1,r:.5,duration:.25,max:.8,osc_0_type:'sine',osc_0_detune:5,osc_1_type:'sine',osc_1_detune:-5},{filter:t({freq:200,Q:1,type:'highpass',gain:2,input_gain:1,a:0,d:.15,s:.6,r:.3,max:.8,negative:!1,duration:1}),reverb:s({duration:2,decay:5,reverse:!1,freq:600,amount:.2})}),a('lead','lfofilterlead',{gain:2,a:0,d:.5,s:.1,r:.5,duration:.25,max:.8,osc_0_type:'sine',osc_0_detune:5,osc_1_type:'sine',osc_1_detune:-5},{filter:t({freq:200,Q:1,type:'highpass',gain:2,input_gain:1,a:0,d:.15,s:.6,r:.3,max:.8,negative:!1,duration:1}),reverb:s({duration:2,decay:5,reverse:!1,freq:600,amount:.2})}),a('pads','stringssolo',{gain:4,r:.3,a:.1,duration:.2,osc_0_type:'sawtooth',osc_0_detune:2,osc_1_type:'sawtooth',osc_1_detune:-2},{filter:t({freq:200,Q:1,type:'highpass'}),reverb:s({duration:3,decay:20,reverse:!1,freq:1e3,amount:.4})}),a('lead','delaysynthlead1',{gain:8,r:.6,a:0,duration:.3,osc_0_type:'sawtooth',osc_0_detune:0,osc_1_type:'sine',osc_1_detune:0},{filter:t({lfo_type:'sine',lfo_freq:8,lfo_gain:1e3,freq:2e3,Q:2,type:'bandpass',gain:1,input_gain:1}),delay:n({delay:.33,feedback:.2}),reverb:s({duration:2,decay:10,reverse:!1,freq:1e3,amount:.4})}),a('lead','plucked',{gain:2,a:0,d:.1,s:.3,r:.5,duration:.25,max:1,osc_0_type:'triangle',osc_0_detune:0,osc_1_type:'triangle',osc_1_detune:1200,a_pitch:.01,d_pitch:.1,s_pitch:2,r_pitch:.001,duration_pitch:.008,max_pitch:1},{filter:t({type:'lowpass',Q:.5,freq:5e3,a:.01,d:0,s:1,r:.9,duration:.02,max:1,negative:!1}),reverb:s({duration:10,decay:100})}),a('lead','goldeneyeguitar',{gain:3,a:0,d:.1,s:.4,r:2,duration:.5,max:.8,osc_0_type:'sawtooth',osc_0_detune:0,osc_1_type:'square',osc_1_detune:0},{filter:t({lfo_gain:0,type:'bandpass',Q:2.5,freq:500,gain:1,input_gain:1,a:.001,d:.2,s:1,r:1,max:1,negative:!1,duration:.5}),reverb:s({duration:3,decay:10,reverse:!1,freq:2e3,amount:.4})}),a('lead','tronskeyboard',{gain:4,noise:!1,a:0,d:.01,s:.5,r:.1,duration:.15,max:.1,osc_0_type:'square',osc_0_detune:0,osc_1_type:'square',osc_1_detune:-1200},{filter:t({type:'lowpass',Q:5,freq:5e3,gain:1,input_gain:1,a:0,d:.15,s:.1,r:.3,max:.8,duration:.15}),panner:r({lfo_type:'sine',lfo_freq:.1,lfo_gain:0}),reverb:s({duration:4,decay:20,reverse:!1,freq:1e3,amount:.4})}),a('lead','softsquare',{gain:3,a:0,d:.01,s:.4,r:.5,duration:.1,max:1,osc_0_type:'square',osc_0_detune:0,osc_1_type:'square',osc_1_detune:0},{filter:t({lfo_gain:0,type:'lowpass',Q:1,freq:5e3,gain:1,input_gain:1,a:.001,d:.2,s:.4,r:1,max:1,negative:!1,duration:.5}),reverb:s({duration:2,decay:10,reverse:!1,freq:500,amount:.3})}),a('lead','kraftwerker',{gain:2,noise:!1,a:0,d:.01,s:.5,r:.1,duration:.15,max:.1,osc_0_type:'sawtooth',osc_0_detune:10,osc_1_type:'square',osc_1_detune:-1210},{filter:t({type:'lowpass',Q:10,freq:6100,gain:2,input_gain:1,a:0,d:.15,s:.1,r:.3,max:.8,duration:.15}),delay:n({delay:.15,feedback:.1}),panner:r({lfo_type:'sine',lfo_freq:.1,lfo_gain:0}),reverb:s({duration:4,decay:20,reverse:!1,freq:1e3,amount:.4})}),a('lead','rubberduck',{gain:1.2,a:0,d:.3,s:.5,r:.6,duration:.5,max:.8,osc_0_type:'sawtooth',osc_0_detune:0,osc_1_type:'sine',osc_1_detune:0},{filter:t({type:'lowpass',Q:10,freq:5e3,gain:1,input_gain:1,a:0,d:.05,s:.3,r:.4,max:.1,negative:!1,duration:.5}),reverb:s({duration:3,decay:10,reverse:!1,freq:4e3,amount:.3})}),a('lead','sineserenity',{gain:1.6,a:0,d:.1,s:.3,r:.5,duration:.25,max:.8,osc_0_type:'sine',osc_0_detune:0,osc_1_type:'triangle',osc_1_detune:0},{filter:t({type:'highpass',Q:1,freq:500,gain:3,input_gain:1}),reverb:s({duration:3,decay:8,reverse:!1,freq:5e3,amount:.3})}),a('lead','sineserenitydelay',{gain:1.6,a:0,d:.1,s:.3,r:.5,duration:.25,max:.8,osc_0_type:'sine',osc_0_detune:0,osc_1_type:'triangle',osc_1_detune:0},{filter:t({type:'highpass',Q:1,freq:500,gain:3,input_gain:1}),delay:n({delay:.25,feedback:.4}),reverb:s({duration:3,decay:8,reverse:!1,freq:5e3,amount:.3})}),a('lead','supersaw',{gain:.7,lfo_type:'triangle',lfo_freq:3,lfo_amp:.2,a:0,d:.1,s:.3,r:.5,duration:.25,max:.8,osc_0_type:'sawtooth',osc_0_detune:0,osc_1_type:'sawtooth',osc_1_detune:-10},{filter:t({lfo_type:'sine',lfo_freq:6,lfo_gain:2,type:'highpass',Q:.5,freq:400,gain:5,input_gain:1}),reverb:s({duration:5,decay:40,reverse:!1,freq:2e3,amount:.3})}),a('lead','juicyfunklead',{gain:1,a:0,d:.2,s:.1,r:.5,duration:.15,max:.8,osc_0_type:'sawtooth',osc_0_detune:0,osc_1_type:'sawtooth',osc_1_detune:-1200},{filter:t({lfo_type:'sine',lfo_freq:1,lfo_gain:0,type:'lowpass',Q:5,freq:7e3,gain:5,input_gain:1,a:0,d:.15,s:.1,r:.3,max:.8,negative:!1,duration:.15}),reverb:s({duration:1.5,decay:20,reverse:!1,freq:1e3,amount:.4})}),a('lead','hammondorgan',{gain:1.5,a:0,d:.2,s:.6,r:.5,duration:1,max:.5,osc_0_type:'sine',osc_0_detune:0,osc_1_type:'sine',osc_1_detune:0},{filter:t({type:'lowpass',Q:5,freq:3e3,gain:1,input_gain:1}),reverb:s({duration:2.5,decay:15,reverse:!1,freq:4e3,amount:.5})}),a('lead','wobblecopter',{gain:2,lfo_type:'triangle',lfo_freq:3,lfo_amp:.2,a:0,d:.1,s:.3,r:.5,duration:.25,max:.8,osc_0_type:'triangle',osc_0_detune:0,osc_1_type:'sine',osc_1_detune:-10},{filter:t({lfo_type:'sine',lfo_freq:6,lfo_gain:500,type:'highpass',Q:5,freq:1e3,gain:5,input_gain:1}),reverb:s({duration:4,decay:30,reverse:!1,freq:2e3,amount:.3})}),a('lead','trianglespace',{gain:5,osc_0_type:'triangle',osc_0_detune:0,osc_1_type:'triangle',osc_1_detune:1200},{filter:t({type:'highpass',Q:1,freq:900,gain:1,input_gain:1}),delay:n({delay:.25,feedback:.6}),reverb:s({duration:2,decay:10,reverse:!1,freq:2e3,amount:.4})}),a('pads','analogpad1',{gain:1,a:.5,d:.1,s:1,r:.9,duration:1.5,max:.8,osc_0_type:'sawtooth',osc_0_detune:0,osc_1_type:'triangle',osc_1_detune:0},{filter:t({type:'lowpass',Q:1,freq:2500,gain:1,input_gain:1,a:1,d:.5,s:.8,r:1,max:1,negative:!1,duration:.25}),reverb:s({duration:8,decay:40})}),a('pads','bppad1',{gain:3,a:.7,d:.1,s:1,r:.9,duration:1.5,max:.8,osc_0_type:'sawtooth',osc_0_detune:0,osc_1_type:'square',osc_1_detune:0},{filter:t({type:'bandpass',Q:5,freq:3e3,gain:1,input_gain:1,a:5,d:0,s:.8,r:1,max:1,negative:!1,duration:.5}),reverb:s({duration:8,decay:40})}),a('pads','temporaldrone',{gain:30,lfo_type:'triangle',lfo_freq:[.25,'beats'],lfo_amp:2,a:.1,d:.1,s:1,r:5,duration:1,osc_0_type:'sawtooth',osc_0_detune:10,osc_1_type:'sawtooth',osc_1_detune:-1210},{filter:t({lfo_type:'sine',lfo_freq:.5,lfo_gain:100,type:'bandpass',Q:1,freq:520,gain:.1,input_gain:1}),reverb:s({duration:2,decay:10,reverse:!0,freq:3500,amount:.5})}),a('pads','oldanalogpoly',{gain:2,a:.2,d:.3,s:.8,r:2,duration:.5,max:1,osc_0_type:'square',osc_0_detune:-1200,osc_1_type:'sawtooth',osc_1_detune:0},{filter:t({type:'lowpass',Q:1,freq:200,a:.01,d:.05,s:.3,r:2,max:.1,negative:!1,duration:1}),panner:r({pan:0,lfo_type:'sine',lfo_freq:29,lfo_gain:.4}),reverb:s({duration:4,decay:20,reverse:!1,freq:6e3,amount:.5})}),a('pads','squareslowlpfverb',{gain:6,a:.8,d:.3,s:1,r:2.5,duration:.5,max:1,osc_0_type:'square',osc_0_detune:1200,osc_1_type:'square',osc_1_detune:0},{filter:t({type:'lowpass',Q:1,freq:1e3,gain:1,input_gain:1,a:1,d:.9,s:.5,r:2.5,max:.1,negative:!1,duration:1}),panner:r({pan:0,lfo_type:'sine',lfo_freq:29,lfo_gain:1}),reverb:s({duration:3.5,decay:5,reverse:!1,freq:8e3,amount:.8})}),a('pads','squarepannerpad',{gain:3,a:.1,d:.3,s:1,r:2.5,duration:.5,max:1,osc_0_type:'square',osc_0_detune:1200,osc_1_type:'square',osc_1_detune:0},{filter:t({type:'lowpass',Q:1,freq:8e3,gain:1,input_gain:1,a:1,d:2,s:.8,r:1,max:.1,negative:!1,duration:2}),panner:r({pan:0,lfo_type:'sine',lfo_freq:10,lfo_gain:2}),reverb:s({duration:3.5,decay:5,reverse:!1,freq:500,amount:.8})}),a('pads','brokengate',{gain:2,a:.7,d:1,s:1,r:4,duration:1,max:1,osc_0_type:'sawtooth',osc_0_detune:0,osc_1_type:'square',osc_1_detune:0},{filter:t({type:'bandpass',Q:2,freq:1e3,gain:2,input_gain:1,a:.8,d:.6,s:1,r:0,max:1,negative:!1,duration:1}),delay:n({delay:.33,feedback:.7}),panner:r({pan:0,lfo_type:'sine',lfo_freq:[1/3,'beats'],lfo_gain:100}),reverb:s({duration:4,decay:10,reverse:!1,freq:4e3,amount:.6})}),a('pads','spaceripples',{gain:2.2,a:0,d:.5,s:.4,r:2,duration:1,max:.8,osc_0_type:'sawtooth',osc_0_detune:0,osc_1_type:'square',osc_1_detune:-1200},{filter:t({type:'lowpass',Q:5,freq:6e3,gain:1,input_gain:1,a:.8,d:.05,s:.2,r:2,max:.4,negative:!1,duration:2}),delay:n({delay:.75,feedback:.6}),panner:r({pan:0,lfo_type:'sine',lfo_freq:[.25,'beats'],lfo_gain:5}),reverb:s({duration:5,decay:20,reverse:!1,freq:2e3,amount:.4})}),a('fx','stab','lpresmover',{gain:2,noise:!0,lfo_type:'triangle',lfo_freq:3,lfo_amp:.2,a:.1,d:.1,s:.2,r:.1,duration:.1,max:1},{filter:t({lfo_type:'sine',lfo_freq:.2,lfo_gain:1e3,type:'lowpass',Q:20,freq:800,gain:5,input_gain:1}),delay:n({delay:.15,feedback:.1}),panner:r({lfo_type:'sine',lfo_freq:5,lfo_gain:100}),reverb:s({duration:3,decay:10,reverse:!1,freq:500,amount:.7})}),a('fx','stab','pitchwobbler',{gain:2,monotone:'C3',lfo_type:'triangle',lfo_freq:[.15,'beats'],lfo_amp:100},{filter:t({lfo_type:'sine',lfo_freq:[.75,'beats'],lfo_gain:200,type:'bandpass',Q:2,freq:1e3,gain:4,input_gain:1}),delay:n({delay:.66,feedback:.3}),reverb:s({duration:2,decay:15,reverse:!1,freq:1e3,amount:.4})}),a('crash','crash1',{gain:2,noise:!0,a:0,d:.2,s:.1,r:.5,duration:.15,max:.8},{filter:t({type:'highpass',Q:5,freq:7e3,gain:10,input_gain:1}),reverb:s({duration:5,decay:10,reverse:!1,freq:2e4,amount:.6})}),a('crash','crash2',{gain:2,noise:!0,a:0,d:.2,s:.1,r:.5,duration:.15,max:.8},{filter:t({type:'bandpass',Q:5,freq:9e3,gain:10,input_gain:1}),reverb:s({duration:5,decay:10,reverse:!1,freq:1e4,amount:.6})}),a('crash','crash3',{gain:2,noise:!0,a:0,d:.2,s:.1,r:.5,duration:.15,max:.8},{filter:t({type:'bandpass',Q:5,freq:5e3,gain:5,input_gain:1}),reverb:s({duration:5,decay:10,reverse:!1,freq:1e4,amount:.6})}),e}(),s={esizer:function(e={}){let a=e.bpm||116,t=e.sampleRate||32e3;const n=new AudioContext({latencyHint:'playback',sampleRate:t});function r(){return n.currentTime}const s={},o=n.createGain();o.gain.value=1e-4,o.gain.linearRampToValueAtTime(.5,.5),o.connect(n.destination);const i=1e-6;function c(e,a,t,n,r,s,o,c,u){0===c&&0===s||(function(e,a,t,n,r,s,o,c){c&&(o=Math.max(0,Math.min(o,c-s))),0!==o?(0===t?0===n?e.gain.setValueAtTime(r,s):e.gain.setValueAtTime(a,s):e.gain.setValueAtTime(i,s),o<=t?e.gain.exponentialRampToValueAtTime(a*o/t,s+o):o<=t+n?(t>0&&e.gain.exponentialRampToValueAtTime(a,s+t),e.gain.exponentialRampToValueAtTime(r,s+o)):(t>0&&e.gain.exponentialRampToValueAtTime(a,s+t),n>0&&e.gain.exponentialRampToValueAtTime(r,s+t+n),e.gain.setValueAtTime(r,s+o))):e.gain.setValueAtTime(r,s)}(e,a,t,n,r,o,c,u),function(e,a,t,n,r){r<n&&(t=0),0===t?e.gain.setValueAtTime(i,n):r&&r-n<t?e.gain.exponentialRampToValueAtTime(a+(i-a)*(r-n)/t,r):e.gain.exponentialRampToValueAtTime(i,n+t)}(e,r,s,o+c,u))}function u(e,a,t,n,r,s,o,i,c,u){0===c&&0===o||(function(e,a,t,n,r,s,o,i,c){c&&(o=Math.max(0,Math.min(o,c-s))),0!==o?(0===t?0===n?e.frequency.setValueAtTime(r,s):e.frequency.setValueAtTime(a,s):e.frequency.setValueAtTime(i,s),o<=t?e.frequency.exponentialRampToValueAtTime(a*o/t,s+o):o<=t+n?(t>0&&e.frequency.exponentialRampToValueAtTime(a,s+t),e.frequency.exponentialRampToValueAtTime(r,s+o)):(t>0&&e.frequency.exponentialRampToValueAtTime(a,s+t),n>0&&e.frequency.exponentialRampToValueAtTime(r,s+t+n),e.frequency.setValueAtTime(r,s+o))):e.frequency.setValueAtTime(r,s)}(e,t=a*Math.pow(2,t/12),n,r,s=a*Math.pow(2,s/12),i,c,a,u),function(e,a,t,n,r,s){s<n&&(t=0),0===t?e.frequency.setValueAtTime(r,n):s&&s-n<t?e.frequency.exponentialRampToValueAtTime(a+(r-a)*(s-n)/t,s):e.frequency.exponentialRampToValueAtTime(r,n+t)}(e,s,o,i+c,a,u))}function l(e,a,t,n,r,s,o,i,c,u,l){function p(e){return Math.max(e,20)}u?(t=p(a*(1-t)),s=p(a*(1-s))):(t*=a,s*=a,a=p(.01)),function(e,a,t,n,r,s,o,i,c,u){u&&(o=Math.max(0,Math.min(o,u-s))),0!==o?(0===t?0===n?e.frequency.setValueAtTime(r,s):e.frequency.setValueAtTime(a,s):e.frequency.setValueAtTime(i,s),o<=t?e.frequency.exponentialRampToValueAtTime(a*o/t,s+o):o<=t+n?(t>0&&e.frequency.exponentialRampToValueAtTime(a,s+t),e.frequency.exponentialRampToValueAtTime(r,s+o)):(t>0&&e.frequency.exponentialRampToValueAtTime(a,s+t),n>0&&e.frequency.exponentialRampToValueAtTime(r,s+t+n),e.frequency.setValueAtTime(r,s+o))):e.frequency.setValueAtTime(r,s)}(e,t,n,r,s,i,c,a,0,l),function(e,a,t,n,r,s,o){o<n&&(t=0),0===t?e.frequency.setValueAtTime(r,n):o&&o-n<t?e.frequency.exponentialRampToValueAtTime(a+(r-a)*(o-n)/t,o):e.frequency.exponentialRampToValueAtTime(r,n+t)}(e,s,o,i+c,a,0,l)}function p(e,a){return void 0===e?a:e}function d(e){return'number'==typeof e||'string'==typeof e&&!isNaN(parseInt(e))?1*e:e.length&&e.length>1&&'beats'===e[1]?a/(60*e[0]):0}function f(e){return'number'==typeof e||'string'==typeof e&&!isNaN(parseInt(e))?1*e:e.length&&e.length>1&&'beats'===e[1]?a*e[0]/60:0}function _(e='triangle',a=3,t=0){const r=n.createOscillator();r.type=e;const s=n.createGain();return s.gain.value=t,r.start(0),r.frequency.value=d(a),r.connect(s),{lfo:r,gain:s,configure:function(e){e.type&&(r.type=e.type),e.freq&&(r.frequency.value=d(e.freq)),e.gain&&(s.gain.value=e.gain)},set_freq_atTime:function(e,a){r.frequency.setValueAtTime(d(e),a)},set_freq_atBeat:function(e,a){r.frequency.setValueAtTime(d(e),w(a))},approach_freq_atTime:function(e,a,t){r.frequency.setTargetAtTime(d(e),a,t)},approach_freq_atBeat:function(e,a,t){r.frequency.setTargetAtTime(d(e),w(a),w(t))},set_gain_atTime:function(e,a){s.gain.setValueAtTime(e,a)},set_gain_atBeat:function(e,a){s.gain.setValueAtTime(e,w(a))},approach_gain_atTime:function(e,a,t){s.gain.setTargetAtTime(e,a,t)},approach_gain_atBeat:function(e,a,t){s.gain.setTargetAtTime(e,w(a),w(t))}}}function h(e){var a=2*n.sampleRate,t=n.createBuffer(1,a,n.sampleRate),r=t.getChannelData(0);for(let e=0;e<a;e++)r[e]=2*Math.random()-1;var s=n.createBufferSource();s.buffer=t,s.loop=!0,s.start(0);const o=n.createGain();return o.gain.setValueAtTime(i,0),s.connect(o).connect(e),{id:Math.round(1e5*Math.random()).toString(16),usage:0,noise:s,gainNode:o,connect:o.connect,set_frequency:e=>{osc.frequency.value=e}}}function g(e,a){const t=n.createOscillator();t.type='sawtooth',t.start(0),t.frequency.value=440;const r=n.createGain();return r.gain.setValueAtTime(i,0),a.gain.connect(t.frequency),t.connect(r).connect(e),{id:Math.round(1e5*Math.random()).toString(16),usage:0,osc:t,gainNode:r,lfo:a,connect:r.connect,set_frequency:e=>{t.frequency.value=e},configure:function(e={}){t.type=p(e.osc_type,'sawtooth'),t.detune.value=p(e.detune,0)}}}const m=['B8','A#8','A8','G#8','G8','F#8','F8','E8','D#8','D8','C#8','C8','B7','A#7','A7','G#7','G7','F#7','F7','E7','D#7','D7','C#7','C7','B6','A#6','A6','G#6','G6','F#6','F6','E6','D#6','D6','C#6','C6','B5','A#5','A5','G#5','G5','F#5','F5','E5','D#5','D5','C#5','C5','B4','A#4','A4','G#4','G4','F#4','F4','E4','D#4','D4','C#4','C4','B3','A#3','A3','G#3','G3','F#3','F3','E3','D#3','D3','C#3','C3','B2','A#2','A2','G#2','G2','F#2','F2','E2','D#2','D2','C#2','C2','B1','A#1','A1','G#1','G1','F#1','F1','E1','D#1','D1','C#1','C1','B0','A#0','A0','G#0','G0','F#0','F0','E0','D#0','D0','C#0','C0'],b={B8:7902.133,'A#8':7458.62,A8:7040,'G#8':6644.875,G8:6271.927,'F#8':5919.911,F8:5587.652,E8:5274.041,'D#8':4978.032,D8:4698.636,'C#8':4434.922,C8:4186.009,B7:3951.066,'A#7':3729.31,A7:3520,'G#7':3322.438,G7:3135.963,'F#7':2959.955,F7:2793.826,E7:2637.02,'D#7':2489.016,D7:2349.318,'C#7':2217.461,C7:2093.005,B6:1975.533,'A#6':1864.655,A6:1760,'G#6':1661.219,G6:1567.982,'F#6':1479.978,F6:1396.913,E6:1318.51,'D#6':1244.508,D6:1174.659,'C#6':1108.731,C6:1046.502,B5:987.7666,'A#5':932.3275,A5:880,'G#5':830.6094,G5:783.9909,'F#5':739.9888,F5:698.4565,E5:659.2551,'D#5':622.254,D5:587.3295,'C#5':554.3653,C5:523.2511,B4:493.8833,'A#4':466.1638,A4:440,'G#4':415.3047,G4:391.9954,'F#4':369.9944,F4:349.2282,E4:329.6276,'D#4':311.127,D4:293.6648,'C#4':277.1826,C4:261.6256,B3:246.9417,'A#3':233.0819,A3:220,'G#3':207.6523,G3:195.9977,'F#3':184.9972,F3:174.6141,E3:164.8138,'D#3':155.5635,D3:146.8324,'C#3':138.5913,C3:130.8128,B2:123.4708,'A#2':116.5409,A2:110,'G#2':103.8262,G2:97.99886,'F#2':92.49861,F2:87.30706,E2:82.40689,'D#2':77.78175,D2:73.41619,'C#2':69.29566,C2:65.40639,B1:61.73541,'A#1':58.27047,A1:55,'G#1':51.91309,G1:48.99943,'F#1':46.2493,F1:43.65353,E1:41.20344,'D#1':38.89087,D1:36.7081,'C#1':34.64783,C1:32.7032,B0:30.86771,'A#0':29.13524,A0:27.5,'G#0':25.95654,G0:24.49971,'F#0':23.12465,F0:21.82676,E0:20.60172,'D#0':19.44544,D0:18.35405,'C#0':17.32391,C0:16.3516},y={};let q=60/a,v=0;function k(e){return e*q}function x(e){return e/q}function w(e){return k(e)+v}function T(e,a){const t=y[e],n=t.r,r=0;let s=[];function o(e){return['note','a','s','d','r','duration','max','aPitch','sPitch','dPitch','rPitch','durationPitch','maxPitch'].includes(e)}a.map(a=>{!function(a){const o=a.event+Math.round(33554432*Math.random()).toString(16);switch(a.event){case'note':let i;i=t.useSeconds?Math.max(x(t.duration)+x(n),x(t.pitch.duration)+x(t.pitch.r))+r:Math.max(t.duration+x(n),t.pitch.duration+x(t.pitch.r))+r,y[e].monotone&&(a.note=y[e].monotone.toUpperCase()),s.push({event:'note',id:o,note:function(e){if(!t.maxNote)return e;let a=m.indexOf(t.maxNote.toUpperCase()),n=m.indexOf(e);for(;n<a;)n+=12;return n<m.length?m[n]:e}(a.note),time:a.start_beat,duration:i,end:a.start_beat+i});break;case'mixer':s.push({event:'mixer',id:o,gain:a.gain,time:a.beat});break;case'mixerGradual':s.push({event:'mixerGradual',id:o,gain:a.gain,time:a.startBeat,end:a.endBeat});break;case'detune':s.push({event:'detune',id:o,cent:a.cent,osc:a.osc,time:a.beat});break;case'detuneGradual':s.push({event:'detuneGradual',id:o,cent:a.cent,osc:a.osc,time:a.startBeat,end:a.endBeat});break;case'lfoFreq':s.push({event:'lfoFreq',id:o,freq:a.freq,time:a.beat});break;case'lfoFreqGradual':s.push({event:'lfoFreqGradual',id:o,freq:a.freq,time:a.startBeat,end:a.endBeat});break;case'lfoGain':s.push({event:'lfoGain',id:o,gain:a.gain,time:a.beat});break;case'lfoGainGradual':s.push({event:'lfoGain',id:o,gain:a.gain,time:a.startBeat,end:a.endBeat});break;case'gain':s.push({event:'gain',id:o,gain:a.gain,time:a.beat});break;case'gainGradual':s.push({event:'gainGradual',id:o,gain:a.gain,time:a.startBeat,end:a.endBeat});break;case'a':case's':case'd':case'r':case'duration':case'max':s.push({event:a.event,id:o,time:a.beat,[a.event]:a[a.event]});break;case'aPitch':case'sPitch':case'dPitch':case'rPitch':case'durationPitch':case'maxPitch':const c=a.event.substr(0,a.event.length-5);s.push({event:a.event,id:o,time:a.beat,[c]:a[c]});break;case'filterLfoFreq':s.push({event:'filterLfoFreq',id:o,freq:a.freq,time:a.beat});break;case'filterLfoFreqGradual':s.push({event:'filterLfoFreqGradual',id:o,freq:a.freq,time:a.startBeat,end:a.endBeat});break;case'filterLfoGain':s.push({event:'filterLfoGain',id:o,gain:a.gain,time:a.beat});break;case'filterLfoGainGradual':s.push({event:'filterLfoGainGradual',id:o,gain:a.gain,time:a.startBeat,end:a.endBeat});break;case'pan':s.push({event:a.event,id:o,time:a.beat,[a.event]:a[a.event]});break;case'panGradual':s.push({event:'panGradual',id:o,pan:a.pan,time:a.startBeat,end:a.endBeat});break;case'panLfoFreq':s.push({event:'panLfoFreq',id:o,freq:a.freq,time:a.beat});break;case'panLfoFreqGradual':s.push({event:'panLfoFreqGradual',id:o,freq:a.freq,time:a.startBeat,end:a.endBeat});break;case'panLfoGain':s.push({event:'panLfoGain',id:o,gain:a.gain,time:a.beat});break;case'panLfoGainGradual':s.push({event:'panLfoGainGradual',id:o,gain:a.gain,time:a.startBeat,end:a.endBeat})}}(a)}),s.sort((e,a)=>o(e.event)&&o(a.event)?e.time!==a.time?e.time<a.time?-1:1:'note'===e.event&&'note'===a.event?e.value<a.value?-1:1:'note'===e.event?1:-1:o(e.event)?-1:1);let i=0;for(let e=s.length-1;e>=0;e--)if('note'===s[e].event){i=e;break}let p=null;const d=[];let f;s.map((e,a)=>{if('note'!==e.event)return;for(let t=0;t<d.length;t++)if(d[t]<e.time)return s[a].osc_num=t,d[t]=e.end,void(f=t);if(d.length<5)return s[a].osc_num=d.length,d.push(e.end),void(f=d.length-1);let t=(f+1)%5;s[a].osc_num=t,d[t]=e.end});const _=[];for(let e=s.length-1;e>=0;e--){const a=s[e];void 0!==_[a.osc_num]&&(s[e].cutoff=_[a.osc_num]),_[a.osc_num]=a.time}let q=0;return s.map((e,a)=>{switch(e.event){case'note':const n=a===i;let r;for(let a=0;a<=Number(!t.noise);a++){if(t.oscillators[a][e.osc_num]?r=t.oscillators[a][e.osc_num]:(t.noise?r=h(t.route):(r=g(t.route,t.lfo)).configure({osc_type:t['osc_'+a+'_type'],detune:t['osc_'+a+'_detune']}),t.oscillators[a][e.osc_num]=r),!t.noise&&!t.pitch.enabled)try{r.osc.frequency.setValueAtTime(b[e.note],w(e.time))}catch(e){}let n,s,o;if(t.useSeconds?(n=t.duration,s=x(o=t.pitch.duration)):(n=k(t.duration),o=k(s=t.pitch.duration)),e.cutoff||(e.cutoff=e.time+e.duration+e.r,t.pitch.enabled&&(e.cutoff=Math.max(e.cutoff,e.time+s+x(t.pitch.r)))),c(r.gainNode,t.max,t.a,t.d,t.s,t.r,w(e.time),n,w(e.cutoff)),t.pitch.enabled){const a=t.pitch;u(r.osc,b[e.note],a.max,a.a,a.d,a.s,a.r,w(e.time),o,w(e.cutoff))}}if(t.filter&&t.filter.adsr){let a,r;t.useSeconds?(r=t.duration,a=t.filter.duration):(r=k(t.duration),a=k(t.filter.duration));const s=t.filter;p&&p!==e.time?l(s.filter,s.base_freq,s.max,s.a,s.d,s.s,s.r,w(p),a,s.negative,w(e.time)):e.time,n&&l(s.filter,s.base_freq,s.max,s.a,s.d,s.s,s.r,w(e.time),a,s.negative,w(e.time)+r+s.r+1),p=e.time}break;case'mixer':t.set_mixer_atBeat(e.gain,e.time);break;case'mixerGradual':t.approach_mixer_atBeat(e.gain,e.time,e.end);break;case'detune':t.set_detune_atBeat(e.osc,e.cent,e.time);break;case'detuneGradual':t.approach_detune_atBeat(e.osc,e.cent,e.time,e.end);break;case'lfoFreq':if(!t.lfo)break;t.lfo.set_freq_atBeat(e.freq,e.time);break;case'lfoFreqGradual':if(!t.lfo)break;t.lfo.approach_freq_atBeat(e.freq,e.time,e.end);break;case'lfoGain':if(!t.lfo)break;t.lfo.set_gain_atBeat(e.gain,e.time);break;case'lfoGainGradual':if(!t.lfo)break;t.lfo.approach_gain_atBeat(e.gain,e.time,e.end);break;case'gain':t.set_gain_atBeat(e.gain,e.time);break;case'gainGradual':t.approach_gain_atBeat(e.gain,e.time,e.end);break;case'a':case's':case'd':case'r':case'duration':case'max':t.set_adsr({[e.event]:e[e.event]});break;case'aPitch':case'sPitch':case'dPitch':case'rPitch':case'durationPitch':case'maxPitch':const s=e.event.substr(0,e.event.length-5);t.set_adsr_pitch({[s]:e[s]});break;case'filterLfoFreq':if(!t.filter||!t.filter.lfo)break;t.filter.lfo.set_freq_atBeat(e.freq,e.time);break;case'filterLfoFreqGradual':if(!t.filter||!t.filter.lfo)break;t.filter.lfo.approach_freq_atBeat(e.freq,e.time,e.end);break;case'filterLfoGain':if(!t.filter||!t.filter.lfo)break;t.filter.lfo.set_gain_atBeat(e.gain,e.time);break;case'filterLfoGainGradual':if(!t.filter||!t.filter.lfo)break;t.filter.lfo.approach_gain_atBeat(e.gain,e.time,e.end);break;case'pan':if(!t.panner)break;t.panner.set_atBeat(e.pan,e.time);break;case'panGradual':if(!t.panner)break;t.panner.approach_atBeat(e.pan,e.time,e.end);break;case'panLfoFreq':if(!t.panner)break;t.panner.lfo.set_freq_atBeat(e.freq,e.time);break;case'panLfoFreqGradual':if(!t.panner)break;t.panner.lfo.approach_freq_atBeat(e.freq,e.time,e.end);break;case'panLfoGain':if(!t.panner)break;t.panner.lfo.set_gain_atBeat(e.gain,e.time);break;case'panLfoGainGradual':if(!t.panner)break;t.panner.lfo.approach_gain_atBeat(e.gain,e.time,e.end)}q=e.time}),q}let A=!1;function G(e){if(e!==parseFloat(e))switch(e.toLowerCase()){case'4':case'semibreve':e=4;break;case'2':case'minim':e=2;break;case'1':case'crotchet':e=1;break;case'1/2':case'half':case'quaver':e=.5;break;case'1/3':case'third':case'3rd':case'triplet':e=1/3;break;case'1/4':case'fourth':case'4th':case'semiquaver':e=.25;break;case'1/5':case'fifth':case'5th':case'quintuplet':e=.2;break;case'1/6':case'sixth':case'6th':case'sextuplet':e=1/6;break;case'1/7':case'seventh':case'7th':case'septuplet':e=1/6;break;case'1/8':case'eighth':case'8th':e=.125;break;case'1/16':case'sixteenth':case'16th':e=.0625;break;case'1/32':case'thirtysecond':case'thirty-second':case'thirty second':case'32nd':e=.03125;break;default:e=1}else e<0&&(e=1);return e}return{instruments:y,notes:b,mixer:s,count_oscs:function(){let e=0;for(let a in y){let t=y[a].oscillators[0].length+y[a].oscillators[1].length;console.log(a,':',t),e+=t}return e},now:r,add_instrument:function(e,a={},t={}){const r=p(t.filter,null),i=p(t.delay,null),c=p(t.panner,null),u=p(t.reverb,null),l={oscillators:[[],[]],gain:p(a.gain,1)/10,level:p(a.level,1),a:f(p(a.a,.1)),d:f(p(a.d,.1)),s:p(a.s,.3),r:f(p(a.r,.5)),duration:G(p(a.duration,.25)),max:p(a.max,.8),monotone:p(a.monotone,!1),useSeconds:p(a.useSeconds,!1),maxNote:p(a.maxNote,!1),set_adsr:function(e){h(e.a)&&(l.a=e.a),h(e.d)&&(l.d=e.d),h(e.s)&&(l.s=e.s),h(e.r)&&(l.r=e.r),h(e.duration)&&(l.duration=G(e.duration)),h(e.max)&&(l.max=e.max)},noise:p(a.noise,!1),lfo_type:p(a.lfo_type,'triangle'),lfo_freq:d(p(a.lfo_freq,3)),lfo_amp:p(a.lfo_amp,0),pitch:{a:f(p(a.a_pitch,0)),d:f(p(a.d_pitch,0)),s:p(a.s_pitch,0),r:f(p(a.r_pitch,0)),duration:G(p(a.duration_pitch,0)),max:p(a.max_pitch,0),enabled:!a.noise&&Boolean(a.a_pitch||a.d_pitch||a.s_pitch||a.r_pitch||a.duration_pitch||a.max_pitch)},set_adsr_pitch:function(e){h(e.a)&&(l.pitch.a=e.a),h(e.d)&&(l.pitch.d=e.d),h(e.s)&&(l.pitch.s=e.s),h(e.r)&&(l.pitch.r=e.r),h(e.duration)&&(l.pitch.duration=G(e.duration)),h(e.max)&&(l.pitch.max=e.max),l.pitch.enabled=Boolean(l.pitch.a||l.pitch.d||l.pitch.s||l.pitch.r||l.pitch.duration||l.pitch.max)},osc_0_type:p(a.osc_0_type,'sawtooth'),osc_0_detune:p(a.osc_0_detune,0),osc_1_type:p(a.osc_1_type,'sawtooth'),osc_1_detune:p(a.osc_1_detune,0),set_detune_atTime:function(e,a,t){l.noise||l.available[e].map(e=>{e.osc.detune.setValueAtTime(a,t)})},set_detune_atBeat:function(e,a,t){l.noise||l.available[e].map(e=>{e.osc.detune.setValueAtTime(a,w(t))})},approach_detune_atTime:function(e,a,t,n){l.noise||l.available[e].map(e=>{e.osc.detune.setTargetAtTime(a,t,n)})},approach_detune_atBeat:function(e,a,t,n){l.noise||l.available[e].map(e=>{e.osc.detune.setTargetAtTime(a,w(t),w(n))})},set_gain_atTime:function(e,a){l.gainNode.gain.setValueAtTime(e,a)},set_gain_atBeat:function(e,a){l.gainNode.gain.setValueAtTime(e,w(a))},approach_gain_atTime:function(e,a,t){l.gainNode.gain.setTargetAtTime(e,a,t)},approach_gain_atBeat:function(e,a,t){l.gainNode.gain.setTargetAtTime(e,w(a),w(t))},set_mixer_atTime:function(e,a){l.mixerNode.gain.setValueAtTime(e,a)},set_mixer_atBeat:function(e,a){try{l.mixerNode.gain.setValueAtTime(e,w(a))}catch(e){}},approach_mixer_atTime:function(e,a,t){l.mixerNode.gain.setTargetAtTime(e,a,t)},approach_mixer_atBeat:function(e,a,t){l.mixerNode.gain.setTargetAtTime(e,w(a),w(t))},lfo:null,gainNode:n.createGain(),mixerNode:n.createGain(),filter:r,delay:i,panner:c,reverb:c,route:null};function h(e){return void 0!==e}l.noise||(l.lfo=_(l.lfo_type,l.lfo_freq,l.lfo_amp)),l.gainNode.gain.value=l.gain,l.gainNode.connect(l.mixerNode).connect(o),s[e]=l.mixerNode;let g=l.gainNode;u&&(u.output.connect(g),g=u.input),c&&(c.connect(g),g=c),i&&(i.output.connect(g),g=i.input),r&&(r.gainNode.connect(g),g=r.input),l.route=g,y[e]=l},play_music:function(e){v=r()+k(4);let a=0;for(let t in e)a=Math.max(a,T(t,e[t]));o.gain.setValueAtTime(0,w(a)+5)},filter:function(e={}){const a=n.createBiquadFilter(),t=n.createGain();a.type=p(e.type,'bandpass'),a.Q.value=p(e.Q,1),a.frequency.value=d(p(e.freq,320));const r=f(p(e.a,0)),s=f(p(e.d,0)),o=p(e.s,0);let i=f(p(e.r,0));const c=p(e.max,0),u=p(e.negative,!1);let l=G(p(e.duration,0));const h=Boolean(r||s||o||i||c||l);h&&(i=Math.max(i,.01),l=Math.max(l,.01));const g=a.frequency.value;let m;if(h)m=null;else{let t=p(e.lfo_gain,0);t>a.frequency.value&&(t=a.frequency.value-1),(m=_(p(e.lfo_type,'sine'),d(p(e.lfo_freq,1)),t)).gain.connect(a.frequency)}const b=n.createGain();return t.gain.value=e.gain||Math.min(1,1/a.Q.value),t.connect(a).connect(b),{input:t,filter:a,lfo:m,gainNode:b,connect:b.connect,set_freq_atTime:function(e,t){a.adsr||a.frequency.setValueAtTime(e,t)},set_freq_atBeat:function(e,t){a.adsr||a.frequency.setValueAtTime(e,w(t))},approach_freq_atTime:function(e,t,n){a.adsr||a.frequency.setTargetAtTime(e,t,n)},approach_freq_atBeat:function(e,t,n){a.adsr||a.frequency.setTargetAtTime(e,w(t),w(n))},a:r,d:s,s:o,r:i,max:c,negative:u,adsr:h,base_freq:g,duration:l}},delay:function(e={}){const a=p(e.delay,1),t=p(e.feedback,.5),r=n.createGain();if(0===a)return{input:r,output:r};const s=n.createGain(),o=n.createGain();o.gain.value=t;const i=n.createDelay(k(a));return i.delayTime.value=k(a),r.connect(s),r.connect(o).connect(i).connect(s),i.connect(o),{input:r,output:s}},panner:function(e={}){const a=p(e.pan,0),t=n.createStereoPanner();t.pan.value=a;const r=_(p(e.lfo_type,'sine'),d(p(e.lfo_freq,.1)),p(e.lfo_gain,0));return r.gain.connect(t.pan),t.lfo=r,t.set_atTime=function(e,a){t.pan.setValueAtTime(e,a)},t.set_atBeat=function(e,a){t.pan.setValueAtTime(e,w(a))},t.approach_atTime=function(e,a,n){t.pan.setTargetAtTime(e,a,n)},t.approach_atBeat=function(e,a,n){t.pan.setTargetAtTime(e,w(a),w(n))},t},reverb:function(e={}){let a=f(p(e.duration,1)),t=p(e.decay,2),r=p(e.reverse,!1),s=d(p(e.freq,1e4)),o=p(e.amount,1);const i=n.createBiquadFilter();i.type='lowpass',i.Q.value=.5,i.frequency.value=s;const c=n.createGain(),u=n.createGain(),l=n.createGain();u.gain.value=o,l.gain.value=1-o;let _=n.createConvolver();_.buffer=function(e,a=2,t){for(var r=n.sampleRate,s=r*e,o=n.createBuffer(2,s,r),i=o.getChannelData(0),c=o.getChannelData(1),u=0;u<s;u++){var l=t?s-u:u;i[u]=(2*Math.random()-1)*Math.pow(1-l/s,a),c[u]=(2*Math.random()-1)*Math.pow(1-l/s,a)}return o}(a,t,r);const h=n.createGain();return c.connect(i).connect(u).connect(_).connect(h),c.connect(l).connect(h),{input:c,filter:i,convolver:_,output:h}},Beats:k,set_bpm:function(e){a=e,q=60/e},kill:async function(){await n.close()},pause:function(){A||(A=!0,n.suspend())},resume:function(){A&&(A=!1,n.resume())},isFinished:function(){return 0===o.gain.value}}}({sampleRate:[22050,32e3,44100][Math.min(2,Math.max(0,n))]})},o=0;function i(){return(o=function(){let e=JSON.stringify(arguments),a=2166136261;for(let t=0;t<e.length;++t)a^=e.charCodeAt(t),a+=(a<<1)+(a<<4)+(a<<7)+(a<<8)+(a<<24);return a>>>0}(e,a,o))%1e9/1e9}return{trackLength:1e3*function(e,a){const t=e.Beats,n=0===a;function s(e,a){return e+(a-e)*i()}function o(e,a){return Math.round(s(e,a))}function c(e){return e[Math.floor(i()*e.length)]}function u(){return c(arguments)}function l(e){return s(0,1)<=e}const p=70+Math.round(.75*a)+o(0,21),d={};let f,_,h,g;const m={'Bebop dominant scale':'W-W-H-W-W-H-H-H','Blues scale':'3H-W-H-H-3H-W',Dorian:'W-H-W-W-W-H-W','Enigmatic scale':'H-3H-W-W-W-H-H','Flamenco mode':'H-3H-H-W-H-3H-H','Half diminished scale':'W-H-W-H-W-W-W','Harmonic major scale':'W-W-H-W-H-3H-H','Harmonic minor scale':'W-H-W-W-H-3H-H','Hirajoshi scale':'2W-W-H-2W-H','Miyako-bushi scale':'H-2W-W-H-2W','Insen scale':'H-2W-W-3H-W',Ionian:'W-W-H-W-W-W-H',Lydian:'W-W-W-H-W-W-H','Major pentatonic scale':'W-W-3H-W-3H','Minor pentatonic scale':'3H-W-W-3H-W',Phrygian:'H-W-W-W-H-W-W'},b=['B','A#','A','G#','G','F#','F','E','D#','D','C#','C'];function y(e){let a=[0],t=0;m[e].split('-').map(e=>{t+=function(e){return 1===(e=e.toUpperCase()).length?'W'===e?2:1:parseInt(e[0])*('W'===e[1]?2:1)}(e),a.push(t)});let n=[];for(let e=0;e<=12;e++)if(a.includes(e))n.push(e);else for(let t=1;t<12;t++){if(a.includes(e-t)){n.push(e-t);break}if(a.includes(e+t)){n.push(e+t);break}}return n}function q(){const e=n?'Phrygian':c(Object.keys(m)),a=y(e);return{key:{note:c(b),octave:o(2,4),mid_shift:a[u(2,4,6)],bridge_shift:c(a)},timeSignature:[o(4,4),4],scale:e,tempo:p,lengths:function(){const e={intro:o(2,4),outro:o(2,4),breakdown:o(2,3),buildup:o(1,2),bridge:o(3,4),'main-section':o(3,4),chorus:o(3,4),'pre-chorus':0,solo:o(4,5),drop:0,'pre-drop':0,tension:0,release:0,verse:o(3,4)};let a=e.solo,t=1;e['main-section']>a&&(e['main-section']=a-1),a=e['main-section'],e.bridge=e.verse=e.chorus=a,e.bridge>a&&(e.bridge=a-(0===t?0:l(.5)?(t--,1):0)),a=e.bridge,e.intro>=a&&e.intro--,e.outro=e.intro,a=e.outro,e.breakdown>=a&&(e.breakdown=Math.max(2,a-1)),e.drop=e.breakdown,a=e.breakdown,e['pre-chorus']=e.tension=e.release=e.buildup;for(let a in e)e[a]=Math.pow(2,e[a]);return e}()}}function v(e,a,t){function n(e,a){function t(e,a,t){const n=function(e){const a=y(e);let t=[];for(let e=0;e<2;e++)a.map(a=>{t.includes(a+12*e)||t.push(a+12*e)});return t}(t);return n[n.indexOf(e)+a-1]}let n=s(0,1);const r=[e];return n<.85?r.push(t(e,3,a),t(e,5,a)):n<.9?r.push(t(e,3,a)-1,t(e,5,a)-1):n<.95?r.push(t(e,3,a),t(e,5,a)+1):(r.push(t(e,3,a)),s(0,1)<.5?r.push(t(e,2,a)):r.push(t(e,4,a))),(n=s(0,1))<.08?r.push(t(e,7,a)):n<.12?r.push(t(e,9,a)):n<.14&&r.push(t(e,6,a)),r}function r(e,a,t,n,r){const s=[];for(let n=0;n<a;n++)s.push((Math.floor(n/a*e)+t)%e);const o=[];for(let a=0;a<r/n;a++)s.includes(a%e)&&o.push(a*n);return o}function i(e,a,t,n,i,c,u,l){const p=Math.round(l/u),d=y(e),f={};for(;d.length>a;)d.splice(o(0,d.length-1),1);return d.map(e=>{const a=1+Math.round(s(t,n)*(p-1)),d=o(Math.round(a*i),Math.round(a*c)),_=o(0,a);f[e]=r(a,d,_,u,l)}),f}function p(e,a,t,n,i,c,u,l,p){const d=y(e);for(;d.length>a;)d.splice(o(0,d.length-1),1);const f=1/16,_=2*Math.round(o(l,p)/2),h={};function g(e,a,t,n,i,c,u){const l=o(t,n),p=32*l/4,_={};return d.map(e=>{const a=o(i,c),t=Math.round(s(0,u)*p);_[e]=r(p,a,t,f,l/4)}),{note_length:l,sequence:_}}d.map(e=>{h[e]=[]});let m=0;for(let e=0;e<_;e++){const e=g(0,0,t,n,i,c,u);for(let a in e.sequence)e.sequence[a].map(e=>{h[a].push(m+e)}),m+=e.note_length}return h}function d(e,a,t,r,i,c){const l=n(a,e);let p=[];if(i)l.map(e=>{void 0!==e&&p.push(e)}),-1===i&&p.reverse();else{for(;l.length>0;){let e;void 0!==(e=0===p.length?l.splice(0,1)[0]:l.splice(o(0,l.length-1),1)[0])&&p.push(e)}if(s(0,1)<.3){const e=[];p.map(a=>{e.splice(0,0,a)}),e.splice(0,1),e.pop(),p.push(...e)}}const d=c?0:o(1,2),f=s(0,1)<.8,_=s(0,2),h={};let g=!1,m=0;for(let e=0;e<r/t;e)for(let a=0;a<=d;a++){const n=f?12*(d-a):12*a;for(let a=0;a<=_;a++)for(let a=0;a<p.length;a++){const s=p[a],o=1*s+n;if(isNaN(o)&&console.error('ERROR:',s,n),h[o]||(h[o]=[]),h[o].push(e*t),g)e+=.5,g=!1;else if(m)e+=1/3,++m>=3&&(m=!1);else{const a=u(.5,.5,.5,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2);'third'===a?(e+=1/3,m++):(e+=a,g=.5===a)}if(e>=r/t)return h}}return h}function f(e,a,t,n,r,i,p=!1){const d=y(e),f={};for(;d.length>a;)d.splice(o(0,d.length-1),1);let _,h=!1,g=0,m=d.length-1,b=!!i||l(.5);p&&(b=!1);for(let e=0;e<r/n;e)if(i?(_=d[m],l(.6)&&m--,m<0&&(m+=d.length)):_=c(d),l(.1)&&!p&&(b=!b),_+=12*b,!(s(0,1)<t))if(f[_]||(f[_]=[]),f[_].push(e*n),h)e+=.5,h=!1;else if(g)e+=1/3,++g>=3&&(g=!1);else{const a=u(.5,.5,.5,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2);'third'===a?(e+=1/3,g++):(e+=a,h=.5===a)}return f}function _(e,a,t,n,r,s){return d(e,n?0:c(y(e)),a,t,r,s)}function h(e,a,t,n){const r=y(e);function o(e,a,t,n,o,i){e=parseInt(e),a=parseInt(a);const c={};c[e]=[t];let p=e;function d(o){let i=(l=e+Math.round(o/n*(a-e)))>12?r[l%12]+12:l<0?-12+r[12+l%12]:r[l];var l;i===p&&s(0,1)<.5&&(i+=u(-1,1)),p=i,c[i]||(c[i]=[]),c[i].push(t+o)}for(let e=o;e<n;e+=o)d(e),l(i)&&d(e+o*u(-.25,.25,.5));return c}const i=a;let c=[];for(let e in i)i[e].map(a=>{c.push({beat:a,shift:e})});c.sort((e,a)=>e.beat<a.beat?-1:1);let p={};for(let e=0;e<c.length-1;e++){const a=o(c[e].shift,c[e+1].shift,c[e].beat,c[e+1].beat-c[e].beat,n);for(let e in a)p[e]||(p[e]=[]),p[e].push(...a[e])}return p}function g(e,a){const t=a;let r={};for(let a in t)n(a,e).map(e=>{r[e]||(r[e]=[]),t[a].map(a=>{r[e].includes(a)||r[e].push(a)})});return r}function m(){return a.timeSignature[0]/a.timeSignature[1]}function b(e){return m()*e}const q={leaders:{},leaders2x:{},chords:{},chords2x:{},pulsed_chords:{},arpeggiated_leaders:{},walks:{},crashes:{},sweeps:{up:{},down:null},stabs:[],fills:{},rhythms:{a:{},b:{},c:{},d:{},e:{},f:{}},melodies:{},leads:{},arpeggios:{},bass:{},pads:{a:u('leaders',null),b:u('leaders',null),c:u('chords'),d:u('chords'),e:u('leaders',null),f:u('chords')},trimEnds:{breakdown:l(.1),chorus:l(.1),solo:l(.1),'main-section':l(.1)}},v={},k=1/a.timeSignature[0]/2;t.sections.map(e=>{v[e]={lead:null,pads:null,bass:null},q.lengths={};const t=function(e,a,t,n,r){const i=y(e),u={},l={};for(;i.length>a;)i.splice(o(0,i.length-1),1);let p;for(let e=0;e<r/n;e++)p&&s(0,1)<t||(p=c(i)),u[p]||(u[p]=[]),u[p].push(e*n),e%2==0&&(l[p]||(l[p]=[]),l[p].push(e*n));return[l,u]}(a.scale,o(4,8),s(.1,.3),m()/2,b(a.lengths[e]));q.leaders[e]=t[0],q.leaders2x[e]=t[1],q.crashes[e]=function(e){return['chorus','main-section','solo','drop'].includes(e)?{0:[0]}:{}}(e),q.chords[e]=g(a.scale,q.leaders[e]),q.chords2x[e]=g(a.scale,q.leaders2x[e]),q.pulsed_chords[e]=function(e,t){const r=t;let s={};for(let t in r)n(t,e).map(e=>{s[e]||(s[e]=[]),r[t].map(t=>{for(let n=0;n<m();n+=1/a.timeSignature[1])s[e].includes(t+n)||s[e].push(t+n)})});return s}(a.scale,q.leaders[e]),q.arpeggiated_leaders[e]=function(e,a,t){const n=a;let r=[];for(let e in n)n[e].map(a=>{r.push({note_time:a,shift:e})});r.sort((e,a)=>e.note_time<a.note_time?-1:1);const s={};let o;o=r.length>1?r[1].note_time-r[0].note_time:2;for(let a=0;a<r.length;a++){const n=r[a].note_time,i=d(e,r[a].shift,t,o);for(let e in i)s[e]||(s[e]=[]),i[e].map(a=>{a>=o||s[e].push(a+n)})}return s}(a.scale,q.leaders[e],k),q.walks[e]=h(a.scale,q.leaders[e],0,k)});for(let e in v)switch(e){case'intro':v[e].lead=u('ma','aa','ab'),v[e].pads='d';break;case'outro':v[e].lead=u('mb','aa','ab'),v[e].pads='d';break;case'breakdown':v[e].lead=u('md','ab'),v[e].pads='d';break;case'buildup':v[e].lead='mc',v[e].pads='c',v[e].bass='d';break;case'bridge':v[e].lead=u('mf','ab'),v[e].pads='c',v[e].bass='c';break;case'main-section':v[e].lead=u('mb','aa'),v[e].pads='a',v[e].bass='a';break;case'chorus':v[e].lead=u('ma','aa','ab'),v[e].pads='a',v[e].bass='a';break;case'pre-chorus':v[e].lead='mc',v[e].bass='d';break;case'solo':v[e].lead=u('aa','ac'),v[e].pads='b',v[e].bass='b';break;case'drop':v[e].lead=u('ma','aa','ad'),v[e].pads='a',v[e].bass='a';break;case'pre-drop':break;case'tension':v[e].lead='mc',v[e].pads='c',v[e].bass='e';break;case'release':v[e].lead='md',v[e].pads='c',v[e].bass='f';break;case'verse':v[e].lead='me',v[e].pads='b',v[e].bass='b'}q.sweeps.down={0:[0]},e.fxs.sweepup.map(t=>{q.sweeps.up[t]=function(e){return{0:[-(e=e.length?e[0]:e/60*a.tempo)]}}(e.sweepupInset[t])});for(let e=0;e<1.5*t.unique;e++)q.stabs.push(l(.5)?i(a.scale,5,.5,1,.1,.5,k/2,b(1)):f(a.scale,6,.4,k/2,b(1)));function x(e){let t={};for(let n in v){const r=v[n].lead;if(r&&r===e){const e=a.lengths[n];t[e]=!0}}const n=Object.keys(t);return t=[],n.map(e=>{t.push(parseInt(e))}),t.sort((e,a)=>e<a?-1:1),0===t.length?0:1===t.length?1*t[0]:2===t.length?1*t[1]:t.length%2==0?1*t[t.length/2-1]:1*t[Math.floor(t.length/2)]}function w(e){let t={};for(let n in v){const r=v[n].bass;if(r&&r===e){const e=a.lengths[n];t[e]=!0}}const n=Object.keys(t);return t=[],n.map(e=>{t.push(parseInt(e))}),t.sort((e,a)=>e<a?-1:1),0===t.length?0:1===t.length?1*t[0]:2===t.length?1*t[1]:t.length%2==0?1*t[t.length/2-1]:1*t[Math.floor(t.length/2)]}for(let e in v){q.lengths[e]={};const a=v[e].lead;if(a){let t=x(a);q.leads[a]||(q.leads[a]=G(a,t)),q.lengths[e].lead=t}const t=v[e].bass;if(t){let a=w(t);q.bass[t]||(q.bass[t]=B(t,a)),q.lengths[e].bass=a}}function T(e,a,t,n){if(0===e)return{};{n||(n=0);const r={};for(let e in a)r[e]=[];for(let s=0;s<e/t;s++)if((s-n)%2==0)for(let n in a)a[n].map(a=>{const o=a+b(s*t);o<b(e)&&r[n].push(o)});return r}}function A(e,t,n,r,s,o,c=1){if(0===e)return{};{let u;switch(s||(s=0),t){case'descent0':u=_(a.scale,n,b(e/2),!1,-1,!1);break;case'descent':if(l(.95)){u={};for(let t=0;t<=Math.log2(e);t++){const r=2*n*Math.pow(2,t);let s,o=e/2;switch(t){case 0:s=_(a.scale,r,b(o),!1,-1,!1);break;default:s=f(a.scale,4,.8,r,b(o),!0)}const i=b(t);for(let e in s)u[e]||(u[e]=[]),s[e].map(a=>{const t=a+i;u[e].includes(t)||u[e].push(t)})}}else u=f(a.scale,6,.2,n,b(e),!0);break;case'ascent':u={};for(let t=0;t<=Math.log2(e);t++){const r=4*n/Math.pow(2,t);let s,o=Math.pow(2,Math.log2(e)-t);switch(t){case 0:s=_(a.scale,r,b(o),!0,!0,!1);break;default:s=f(a.scale,4,.8,r,b(o))}const i=b(e-o);for(let e in s)u[e]||(u[e]=[]),s[e].map(a=>{const t=a+i;u[e].includes(t)||u[e].push(t)})}break;case'arpeggio_melody':u=_(a.scale,n,b(e),!1);break;case'arpeggio_root':u=_(a.scale,n,b(e),!0);break;case'random_melody':u=f(a.scale,6,.2,n,b(e));break;case'euclidian_melody':u=i(a.scale,5,.5,1,.2,.6,n,b(e))}if(!r)return u;const p={};for(let e in u)p[e]=[];for(let a=0;a<e/c;a++){let e=(a-s)%r==0;if(o&&(e=!e),e){const e=b(a*c),t=b((a+1)*c);for(let a in u)for(let n=0;n<u[a].length&&!(u[a][n]>=t);n++)u[a][n]>=e&&p[a].push(u[a][n])}}return p}}function G(e,a){const t=u(2,4);let n=2!==t&&u(!0,!1),r=u(1,2,Math.max(1,a/4)),s=0;4===t&&n&&(s=1,r=Math.max(1,a/4));const o=u(1,2,4),i=[{},{}],c=a*o/4;switch(e){case'ma':i[1]=u('chords','double_chords',null);for(let e=0;e<a/c;e++){const a=A(c,'random_melody',k);for(let t in a)i[0][t]||(i[0][t]=[]),a[t].map(a=>{i[0][t].push(a+b(e*c))})}return i;case'mb':return[u('chords','double_chords',null),A(a,'random_melody',k)];case'mc':return[A(a,'ascent',k),A(a,'ascent',k)];case'md':return[A(a,'descent',k,t,t/2-s,n,r),A(a,'descent',k,t,0,n,r)];case'me':for(let e=0;e<a/c;e++){const a=A(o,'random_melody',k),t=[T(c,a,o,0),T(c,a,o,1)];for(let a=0;a<i.length;a++){const n=t[a];for(let t in n)i[a][t]||(i[a][t]=[]),n[t].map(n=>{i[a][t].push(n+b(e*c))})}}return i;case'mf':return[u('chords','double_chords',null),A(a,'euclidian_melody',k)];case'aa':i[1]=u('chords','double_chords',null);for(let e=0;e<a/c;e++){const a=A(c,u('arpeggio_melody','arpeggio_root'),k);for(let t in a)i[0][t]||(i[0][t]=[]),a[t].map(a=>{i[0][t].push(a+b(e*c))})}return i;case'ab':for(let e=0;e<a/c;e++){A(o,'random_melody',k);const a=[A(c,u('arpeggio_melody','arpeggio_root'),k,t,0,n,r),A(c,u('arpeggio_melody','arpeggio_root'),k,t,t/2-s,n,r)];for(let t=0;t<i.length;t++){const n=a[t];for(let a in n)i[t][a]||(i[t][a]=[]),n[a].map(n=>{i[t][a].push(n+b(e*c))})}}return i;case'ac':for(let e=0;e<a/c;e++){A(o,'random_melody',k);const a=[A(c,u('arpeggio_melody','arpeggio_root'),k,t,t/2-s,n,r),A(c,u('arpeggio_melody','arpeggio_root'),k,t,0,n,r)];for(let t=0;t<i.length;t++){const n=a[t];for(let a in n)i[t][a]||(i[t][a]=[]),n[a].map(n=>{i[t][a].push(n+b(e*c))})}}return i;case'ad':i[0]=u('chords','double_chords',null);for(let e=0;e<a/c;e++){const a=A(o,u('arpeggio_melody','arpeggio_root'),k);for(let t in a)i[1][t]||(i[1][t]=[]),a[t].map(a=>{i[1][t].push(a+b(e*c))})}return i}}function B(e,t){switch(e){case'a':return'walk';case'b':case'e':return f(a.scale,6,.2,k,b(t),!1,!1);case'c':return _(a.scale,k,b(t),!1,!1,!1);case'd':return'arpeggiate_leader'}}const F=l(.1);function Q(e){for(let a in e)e[a]/=4;return e}for(let t in e.percussion)for(let n in q.rhythms)switch(e.percussion[t].options.category){case'kick':q.rhythms[n][t]=F?p(a.scale,1,4,4,2,6,.5,1,2):u({0:Q([0,1,2,3])},{0:Q([0,2,3])},{0:Q([0,2])},{0:Q([0,2.5])},{0:Q([2.5])});break;case'snare':q.rhythms[n][t]=F?p(a.scale,1,2,8,1,5,.1,1,4):u({0:Q([1])},{0:Q([3])},{0:Q([1,3])},{0:Q([1,2.25,3])},{0:Q([1,1.75,3])},{0:Q([1,3,3.75])},{0:Q([1,3.75])},{0:Q([1.75,3])},{0:Q([1,1.25,2.75,3.5])},{0:Q([1,1.75,3])},{0:Q([1.25,1,3])});break;case'clap':q.rhythms[n][t]=p(a.scale,1,2,8,1,6,.2,1,4);break;case'hat':q.rhythms[n][t]=F?p(a.scale,1,4,16,4,16,1,1,2):u({0:Q([0,.25,.5,.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75])},{0:Q([0,.5,1,1.5,2,2.5,3,3.5])},{0:Q([0,1,2,3])});break;case'perc':default:q.rhythms[n][t]=p(a.scale,1,4,12,1,4,1,1,8)}return function(){for(let n in e.percussion){q.fills[n]=[];for(let r=0;r<2*t.unique;r++)switch(e.percussion[n].options.category){case'kick':q.fills[n].push(p(a.scale,1,2,4,2,6,.5,1,1));break;case'snare':q.fills[n].push(p(a.scale,1,2,8,1,5,.1,1,1));break;case'clap':q.fills[n].push(p(a.scale,1,2,8,1,6,.2,1,1));break;case'hat':q.fills[n].push(p(a.scale,1,4,16,4,16,1,1,1));break;case'perc':default:q.fills[n].push(p(a.scale,1,4,12,1,4,1,1,1))}}}(),q.assignments=v,q}function k(e,a,t,n,r,i){let u;function p(e,a,t){const n=['B','A#','A','G#','G','F#','F','E','D#','D','C#','C'].reverse();let r=n.indexOf(e)+t;if(t>0)for(;r>=n.length;)a++,r-=n.length;else for(;r<0;)a--,r+=n.length;return{note:n[r],octave:a}}function d(e,a){'number'!=typeof a&&(a=parseInt(a)),e=e.toUpperCase();const t=['B','A#','A','G#','G','F#','F','E','D#','D','C#','C'].reverse(),n=parseInt(e.substr(-1,1)),r=e.substr(0,e.length-1);let s,o,i=t.indexOf(r)+a;return i<0?(s=t[t.length-1+i%t.length],o=n+Math.floor(i/t.length)):i>=t.length?(s=t[i%t.length],o=n+Math.ceil(i/t.length)-1):(s=t[i],o=n),o>8?s+n:s+o}function f(e,a){return{event:'note',note:e,start_beat:a}}function _(e,a,t,n,r){const s=[];for(let o in e){const i=d(a+t,o);e[o].map(e=>{i.length>2&&'#'!==i[1]?console.error('!!',i):'number'==typeof i&&isNaN(i)&&console.error('??',i),s.push(f(i,e*r+n))})}return s}u=['buildup','pre-chorus','pre-drop','tension','release'].includes(a)?p(n.key.note,n.key.octave,n.key.mid_shift):'bridge'===a?p(n.key.note,n.key.octave,n.key.bridge_shift):n.key;const h=n.lengths[a],g=n.timeSignature[0]*h,m=t+g;function b(){for(let e in arguments)if(arguments[e]===a)return!0;return!1}function y(s){let o=t,p=[];for(let e=0;e<h;e++)p[e]=l(.3);let d=!1;for(let f in r.percussion){const g=r.percussion[f].options.category;switch(g){case'kick':b('intro','bridge')?d=!1:b('outro','main-section','chorus','drop')?d='a':b('breakdown','solo','verse')?d='b':b('pre-chorus','pre-drop','release')?d='c':b('buildup','tension')&&(d='d');break;case'snare':b('intro','bridge','drop','release','outro')?d=!1:b('main-section','chorus')?d='a':b('verse')?d='b':b('solo')?d=l(.5)?'b':'d':b('buildup','tension')?d='c':b('breakdown')?d='d':b('pre-drop','pre-chorus')&&(d='e');break;case'hat':b('bridge','pre-chorus','drop','pre-drop')?d=!1:b('outro','solo','verse')?d='a':b('chorus')?d=l(.5)?'a':'b':b('main-section')?d='b':b('buildup','tension')?d='c':b('breakdown')?d='d':b('intro')?d='e':b('tension','release')&&(d='f');break;case'clap':b('intro','outro','breakdown','bridge','pre-chorus','drop','tension','release')?d=!1:b('solo','verse')?d='a':b('buildup','pre-drop')?d='b':b('main-section','chorus')&&(d='c');break;case'perc':b('main-section','chorus')?d='a':b('solo','drop','verse')?d='b':b('buildup','pre-chorus','pre-drop')?d='c':b('breakdown','bridge')?d='d':b('intro','tension')?d='e':b('outro','release')&&(d='f')}if(!d)continue;s&&s[g]&&s[g];let m=b('breakdown','buildup','pre-chorus','pre-drop','bridge'),y=!!m&&l(.5);const q=b('buildup','pre-chorus','pre-drop','tension'),v=b('release'),k=i.trimEnds[a];let x=h;k&&(x-=2);let w=0;for(let a=0;a<x;a++){let r;if(m)if(p[a])r=c(i.fills[f]);else{if(y)continue;r=i.rhythms[d][f]}else r=i.rhythms[d][f];let s=1;q&&(s=[1,1,2,4][w]/4/l(.1)?1:2),v&&(s=[4,2,1,1][w]/4/l(.1)?1:2);for(let i=0;i<s;i++)_(r,u.note,u.octave,o+a*n.timeSignature[0]+i/s*a,n.timeSignature[1]/s).map(a=>{a.length>2&&a[1],a.start_beat<t+h*n.timeSignature[0]&&e[f].push(a)});w++}}}function q(s,o){let c=1*t;const l=r.leads[s],p=i.assignments[a].lead;if(!p)return{};o&&o.start;let d=i.leads[p][s],f=i.lengths[a].lead;switch(d){case'arpeggiate_leader':d=i.arpeggiated_leaders[a],f=h;break;case'chords':d=i.chords[a],f=h;break;case'double_chords':d=i.chords2x[a],f=h;break;case'pulsed_chords':d=i.pulsed_chords[a],f=h;break;case null:d={},f=h}for(let a=0;a<h;a+=f)_(d,u.note,u.octave,c+a*n.timeSignature[0],n.timeSignature[1]).map(a=>{a.length>2&&a[1],a.start_beat<t+h*n.timeSignature[0]&&e[l].push(a)})}function v(s){let o=t;const c=r.bass[Object.keys(r.bass)[0]].name,l=i.assignments[a].bass;if(!l)return{};let p=i.bass[l],d=i.lengths[a].bass;switch(p){case'walk':p=i.walks[a],d=h;break;case'arpeggiate_leader':p=i.arpeggiated_leaders[a],d=h;break;case null:p={},d=h}for(let r=0+['buildup','pre-chorus','pre-drop','tension'].includes(a);r<h;r+=d)_(p,u.note,Math.max(1,u.octave-2),o+r*n.timeSignature[0],n.timeSignature[1]).map(a=>{a.length>2&&a[1],a.start_beat<t+h*n.timeSignature[0]&&e[c].push(a)})}function k(s){let o=t;const c=r.pads[Object.keys(r.pads)[0]].name,l=i.assignments[a].pads;if(!l)return{};let p=i.pads[l],d=h;switch(p){case'chords':p=i.chords[a];break;case'double_chords':p=i.chords2x[a];break;case'pulsed_chords':p=i.pulsed_chords[a];break;case'leaders':p=i.leaders[a];break;case'double_leaders':p=i.leaders2x[a];break;case'arpeggiate_leader':p=i.arpeggiated_leaders[a];break;case null:p={}}for(let a=0+b('intro');a<h;a+=d)_(p,u.note,u.octave,o+a*n.timeSignature[0],n.timeSignature[1]).map(a=>{a.length>2&&a[1],a.start_beat<t+h*n.timeSignature[0]&&e[c].push(a)})}switch(n.timeSignature[0],function(s){let o=t;const c=r.crash[Object.keys(r.crash)[0]].name;_(i.crashes[a],u.note,Math.max(1,u.octave-2),o+0*n.timeSignature[0],n.timeSignature[1]).map(a=>{a.length>2&&a[1],a.start_beat<t+h*n.timeSignature[0]&&e[c].push(a)})}(),function(s){let p,d,f,g=t,m=!1,b=!1,y=0,q=!0,v=[];switch(a){case'intro':m=!0,q=!1,y=0,v=['reversepopcorn','lazerchickenverb','lazerchickendelay','lazergoose','bpresmover','lpresmover','pitchwobbler'];break;case'breakdown':y=.2,v=['respunchdelay','reversepopcorn','lazerchickenverb','lazerchickendelay','lazergoose','bpresmover','lpresmover','pitchwobbler'];break;case'buildup':v=['respunchdelay'],m=!0,q=!1,y=.2;break;case'pre-chorus':case'pre-drop':v=['respunchdelay'],m=!0,q=!1,y=0;break;case'bridge':case'main-section':v=['respunchdelay','reversepopcorn','lazerchickenverb','lazerchickendelay','lazergoose','bpresmover','lpresmover','pitchwobbler'],y=.3;break;case'chorus':v=['reversepopcorn'],y=.3;break;case'solo':v=['respunchdelay','reversepopcorn'],y=.8;break;case'tension':v=['respunchdelay','reversepopcorn','lazerchickenverb','lazerchickendelay','lazergoose','bpresmover','lpresmover','pitchwobbler'],m=!0,y=0;break;case'outro':v=['reversepopcorn','lazerchickenverb','lazerchickendelay','lazergoose','bpresmover','lpresmover','pitchwobbler'],b=!0,q=!1,y=.5;break;case'release':v=['lazerchickenverb','lazerchickendelay','lazergoose','bpresmover','lpresmover','pitchwobbler'],y=.5,b=!0;break;case'verse':v=['respunchdelay','reversepopcorn','lazerchickenverb','lazerchickendelay','lazergoose','bpresmover','lpresmover','pitchwobbler'],y=.4}let k=-1;if(m?(p=c(r.fxs.sweepup),(f=_(d=i.sweeps.up[p],u.note,u.octave,g+h*n.timeSignature[0],1)).map(a=>{a.length>2&&a[1],a.start_beat<t+h*n.timeSignature[0]&&e[p].push(a)}),k=h-1):b&&(p=c(r.fxs.sweepdown),(f=_(d=i.sweeps.down,u.note,u.octave,g,n.timeSignature[1])).map(a=>{a.length>2&&a[1],a.start_beat<t+h*n.timeSignature[0]&&e[p].push(a)}),k=0),y)for(let a=0;a<h;a++)l(y/1.5)&&a!==k&&(d=q?c(i.stabs):{0:[o(0,n.timeSignature[0]-1)]},p=c(v),(f=_(d,u.note,Math.max(1,u.octave+o(-1,0)),g+a*n.timeSignature[0],n.timeSignature[1])).map(a=>{a.length>2&&a[1],a.start_beat<t+h*n.timeSignature[0]&&e[p].push(a)}))}(),a){case'intro':q(0,{start:s(0,.4),target:1}),q(1,{start:s(0,.4),target:1}),v(s(0,1)),k(s(0,1)),y({start:s(1,1),target:1});break;case'outro':y(),q(0,{target:s(.4,1)}),q(1,{target:s(.4,1)}),v(),k();break;case'breakdown':y(),q(0),q(1),v(),k();break;case'buildup':y(),v(),q(0,{start:.5,target:1}),q(1,{start:.5,target:1}),k();break;case'bridge':y();const p=[!1,!1,!1,!1];for(let e=0;e<p.length;e++)p[e]=l(.8);!p.includes(!0)&&l(.9)&&(p[o(0,3)]=!0),p[0]&&q(0),p[1]&&q(1),p[2]&&v(),p[3]&&k();break;case'main-section':case'chorus':y(),q(0),q(1),v(),k();break;case'pre-chorus':y(),v(),q(0,{start:.4,target:1}),q(1,{start:.4,target:1}),k();break;case'solo':y(),q(0),q(1),v(),k();break;case'drop':q(0),q(1),v(),k(),y();break;case'pre-drop':y(),v(),q(0,{start:.6,target:1}),q(1,{start:.4,target:1}),k();break;case'tension':y(),q(0,{start:.2,target:1}),q(1,{start:.5,target:1}),v(),k();break;case'release':y(),q(0),q(1,{start:1,target:.2}),v(),k();break;case'verse':y(),q(0),q(1),v(),k()}return m}const x=function(){f=function(){function e(){const e=[[1,'breakdown'],[2,'buildup'],[1,'bridge'],[4,'main-section'],[5,'chorus'],[2,'solo'],[1,'drop'],[1,'tension'],[1,'release'],[4,'verse']];e.sort((e,a)=>e[0]<a[0]?-1:1);let a=[],t=0;e.map(e=>{t+=e[0],a.push([t,e[1]])});let n=s(0,t);for(let e=0;e<a.length;e++)if(n<=a[e][0])return a[e][1]}const a=[];let t=0;function n(e){if(!['buildup','tension'].includes(c()))switch(e){case'chorus':r('pre-chorus',.3);break;case'drop':r('pre-drop',.8)}c()!==e&&(a.includes(e)||t++,a.push(e))}function r(e,a){l(a)&&n(e)}function i(e){let t=0;for(;!(t++>30);){let t=o(0,a.length-1);if(!('intro'===a[t]||'main-section'===a[t]&&'drop'===a[t-1]||'chorus'===a[t]&&'pre-chorus'===a[t-1]||'drop'===a[t]&&'pre-drop'===a[t-1]||a[t]===e||a[t-1]===e)){'chorus'===e&&l(.3)&&a.splice(t,0,'pre-chorus'),a.splice(t,0,e);break}}}function c(){return a[a.length-1]}function p(e,a){const t=['tension','buildup','outro'];return!(t.includes(e)&&t.includes(a))}r('intro',.5);const d=o(3,12);for(let a=0;a<d;a++){let t=e(),r=0,s=30;for(;(!p(t,c())||t===c()||0===a&&['bridge','solo','breakdown'].includes(t))&&!(r++>s);)t=e();n(t),'drop'===t&&n(u('main-section','verse'))}r('outro',.5),function(e){return!['buildup','bridge','tension'].includes(e)}(c())||n('outro');let f=0,_=0;if(a.map(e=>{f+='chorus'===e,_+='verse'===e}),1===f&&(i('chorus'),f++),f>0)for(;_<2;)i('verse'),_++;return['intro','pre-chorus','pre-drop','tension'].includes(a[0])||(a.splice(0,0,'intro'),t++),['release','chorus','main-section','outro'].includes(c())||n('outro'),{sections:a,unique:t}}(),_=q(),e.set_bpm(_.tempo),g=function(a){const t={percussion:5,bass:1,lead:2,pads:1,crash:1,fx:r.fx.length},s={percussion:{},bass:{},crash:{},lead:{},leads:[],pads:{},fx:{},sweepupInset:{},fxs:{sweepup:[],sweepdown:[],stab:[]}},i={kick:!1,snare:!1,clap:!0,hat:!1,perc:!l(.8)};i.clap&&t.percussion--,i.perc&&t.percussion--;for(let a in t){let c=0;for(let u=0;u<t[a];u){let t,l=!1;if('percussion'!==a){if(n&&['lead','pads','bass'].includes(a)){let e;e='pads'===a?'analogpad1':'bass'===a?'neurobass':0===s.leads.length?'sineserenity':'sineserenitydelay';let n=-1;for(let t=0;t<r[a].length;t++)if(r[a][t][0]===e){n=t;break}n<0&&(n=o(0,r[a].length-1)),t=r[a].splice(n,1)[0]}else t=r[a].splice(o(0,r[a].length-1),1)[0];if('fx'===a){const e=t[1].category;l='sweepup'===e,s.fxs[e].push(t[0])}}else{const e=o(0,r[a].length-1),n=r[a][e][1].category;if(i[n]){if(++c>100)break;continue}t=r[a].splice(e,1)[0],i[n]=!0}const p={name:t[0],options:t[1],components:t[2]};s[a][p.name]=p,'lead'===a&&s.leads.push(p.name);const d={};for(let a in p.components)d[a]=e[a](p.components[a]);l&&(s.sweepupInset[p.name]=p.components.filter.a),e.add_instrument(p.name,p.options,d),u++}}return s}(),h=v(g,_,f);const a={crash:!0,lead:!0,fx:!0,pads:!0,bass:!0,percussion:!0};for(let e in a)for(let a in g[e])d[a]=[];let i=0;return f.sections.map(e=>{i=k(d,e,i,_,g,h)}),t(i)}();return e.play_music(d),{properties:_,score:d,structure:f,elements:h,instruments:g,trackLength:x}}(s.esizer,t).trackLength,pause:s.esizer.pause,resume:s.esizer.resume,kill:async function(){await s.esizer.kill(),delete s.esizer},isFinished:s.esizer.isFinished}};